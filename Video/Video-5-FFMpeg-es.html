<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Video - 5 FFMpeg</title></head><body>
<h2>FFMpeg</h2>
FFMpeg es una herramienta extremadamente poderosa para convertir video
de un formato a otro. Todos los codecs prinicpales funcionan, y aún
muchos otros codecs menos conocidos. Desafortunadamente, la única
manera de usar esta herramienta es a través de comandos en la línea de
comandos.<br>

<br>Para introducir comandos, necesitas lanzar un programa de
"Terminal". En Ubuntu puedes accesar este programa a través de
Aplicaciones -&gt; Accesorios -&gt; Terminal.<br>

<br>Una vez en el Terminal, puedes ingresar comandos para operar
programas. (Dos comandos importantes pero no relacionados con FFMpeg
son: "ls" - produce una lista de todos los archivos en el directorio en
el que te encuentras, y "cd" - cambia el directorio. Por ejemplo puedes
ingresar "cd Descargas" desde tu directorio principal para ir al
directorio de Descargas. Tu línea de entrada te va a mostrar el
directorio en el que te encuentras; la tilde "~" significa que estás en
tu directorio principal /home/usuario.)<br>

<br>Las primeras dos cosas que puedes hacer con FFMpeg son hacer una
lista de los formatos y codecs que esta copia soporta. Esto puede
cambiar basado en lo que tengas instalado en tu computador, por lo que
es mejor revisar esto antes de ingresar un comando, para asegurante que
tengas el soporte correcto disponible.&nbsp; <br>Para ver una lista de todos lost formatos contenedores ingresa: ffmpeg -formats<br>Para ver una lista de todos los codecs ingresa:&nbsp; ffmpeg -codecs<br>

<br>Para convertir un video, simplemente ingresa el comando "ffmpeg" con cuatro partes adicionales:<br>

ffmpeg [entrada] [opciones de video] [opciones de audio] [salida]<br>

<br>La parte del video de entrada se compone de una "-i" y el nombre
del video (o audio) que tienes que quieres convertir a otro tipo.
Puedes tener más de uno de estos archivos de entrada (y cada uno recibe
su propia "-i") si por ejemplo tienes un video con una pista de audio
en un archivo diferente.<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i VideoEntrada.mpg ...[opciones de video] [opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg -i PistaDeVideoDeEntrada.mpg -i PistaDeAudioDeEntrada.wav ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono;">

<br>La opciones de video es donde especificas el codec (con el prefijo
"-vcodec") y el bit-rate (con la opción "-b"). Además puedes
especificar un preset de video ("-vpre") sin el cual la codificación
x264 no va a comenzar (algunos presets sencillos son: slow, medium,
fast), y puedes especificar un tamaño ("-s") ya sea con una referencia
a un tamaño estándar o con el formato ANCHOxALTO.<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[entrada] -vcodec mpeg2 -b 3000k ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -vcodec libtheora -b 3000k ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -vcodec libx264 -preset medium -b 3000k ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -vcodec mpeg2 -b 3000k -s hd480 ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -vcodec mpeg2 -b 3000k -s vga ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">
ffmpeg [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -vcodec mpeg2 -b 3000k -s 1280x720 ...</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[opciones de audio] [salida]</span><big><br>
</big>
<br>Las opciones de audio es donde especificas el condec de audio
("-acodec") y el bit-rate ("-ab"). También es posible especificar no
audio ("-an") para obtener solamente video en el archivo de salida.<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] -acodec flac ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">salida</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"> -acodec libmp3lame -ab 256k ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">salida</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"> -acodec libvorbis -ab 192k ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">salida</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"> -acodec libfaac -ab 192k ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">salida</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]<br>
ffmpeg </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">opciones de video</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"> -an ...[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">salida</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">]</span><br>

<br>La salida es donde especificas el nombre del archivo al cual se
grabará el video convertido. Usualmente la extensión del nombre del
archivo (.mkv, .mp4,
.avi, etc) le permitirá al programa determinar qué formato debe usarse
para el archivo, sin embargo esto es ambiguo si quieres usar un formato
que no está asociado con esa extensión de archivo; en ese caso puedes
usar "-f" y el nombre del formato deseado. (Estos comandos siempre van a
almecenar el archivo de salida en el mismo directorio en el que te
encuentras actualmente.)<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] SalidaVideo.mkv</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">SalidaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.mp4</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] -f dvd </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">SalidaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.mpg</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] -f matroska </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">SalidaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.vid</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] -f mp4 </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">SalidaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.vid</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
[</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">entrada</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);"></span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">] [video options] [audio options] -f avi </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">SalidaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.vid</span><br>

<br>El resultado puede verse como sigue:<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i EntradaVideo.mpg -vcodec mpeg2 -b 3000k -s hd480 -acodec flac SalidaVideo.mkv</span><br>

<br>Codificación a Doble Paso (Two-Pass)<br>Es posible usar ffmpeg para
codificación two-pass. La parte importante es entrar el comando dos
veces, primero con el parámetro "-pass 1" y luego una vez terminado
entrar el mismo comando con el parámetro "-pass 2". En Ubuntu, puedes
hacer un par de cosas adicionales en el primer paso para acelerarlo:
"-an" especifica que no hay un codec de audio que activar. "-f
rawvideo" evita que el programa trate de empacar el video en un formato
especial, solo para descartarlo luego. El "-y /dev/null" especifica que
el archivo de salida va a ir al archivo especial "null", que significa
que solamente desaparecerá en vez de tener que enviar data al disco
duro. Ademas de usar "two-pass", podemos añadir el parámetro "-bt" el
cual le comunica al codec cuanto puede cambiar el bit-rate. Usualmente
va a servir bien el establecer este parámetro igual que el bit-rate.<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i EntradaVideo.mpg -pass 1 -vcodec mpeg2 -b 3000k -bt 3000k -an -f
rawvideo -y /dev/null</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i </span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">EntradaVideo</span><span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">.mpg -pass 2 -vcodec mpeg2 -b 3000k -bt 3000k -acodec flac SalidaVideo.mkv</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<br>Eso es todo lo que hay que saber para operar FFMpeg. No es tan complicado.<br>

<br>Ahora intentemos un ejemplo usando FFMpeg...<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i sintel_clip-ffmpeg.mkv -pass 1 -vcodec libx264 -preset
slow_firstpass -b 1200k -bt 1200k -an -f rawvideo -y /dev/null</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">ffmpeg
-i sintel_clip-ffmpeg.mkv -pass 2 -vcodec libx264 -preset
slow -b 1200k -bt 1200k -acodec libfaac -ab 192k output.mp4</span><br style="font-family: FreeMono; background-color: rgb(204, 204, 204);">

<br>Como bono, puedes configurar el programa para que pueda correr
desde un website, y el video va a comenzar a reproducir antes de que la
descarga termine:<br>

<span style="font-family: FreeMono; background-color: rgb(204, 204, 204);">qt-faststart
output.mp4 webvid.mp4</span><br>

<br>

</body></html>